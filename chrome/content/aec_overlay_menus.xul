<?xml version="1.0" encoding="UTF-8"?>

<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at https://mozilla.org/MPL/2.0/. -->

<?xml-stylesheet href="chrome://attachmentextractor_cont/skin/aec_buttons.css" type="text/css"?>

<!DOCTYPE overlay [
  <!ENTITY % aemainDTD SYSTEM "chrome://attachmentextractor_cont/locale/attachmentextractor.dtd">
  %aemainDTD; 
]>

<overlay id="aec_menusOverlay" 
  xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">

  <!-- Menu 'Message' -->
  <menupopup id="messageMenuPopup">
    <menuseparator id="aec-messageMenuPopup-separator" 
      insertafter="msgAttachmentMenu" />
    <menu id="aec-messageMenuPopup-menu" 
      label="&attachmentextractor.menu.label;" 
      accesskey="&attachmentextractor.menu.accesskey;" 
      insertafter="aec-messageMenuPopup-separator">
      <menupopup id="">
        <menuitem id="menu_aec_justDeleteAttachments" 
          label="&attachmentextractor.justDeleteAttachments.label;" 
          accesskey="&attachmentextractor.justDeleteAttachments.accesskey;" 
          command="cmd_aec_justDeleteAttachments" />
        <menuitem id="menu_aec_extractPatternFolder" 
          label="&attachmentextractor.extractpatternfolder.label;" 
          accesskey="&attachmentextractor.extractpatternfolder.accesskey;" 
          aec_mru_menuitem="NONMRU" 
          command="cmd_aec_extractPatternFolder" 
          hidden="true" />
        <menu id="menu_aec_extractPatternFolder_menu" 
          label="&attachmentextractor.extractpatternfolder.label;" 
          accesskey="&attachmentextractor.extractpatternfolder.accesskey;" 
          aec_mru_menuitem="MRU" 
          command="cmd_aec_extractPatternFolder_menu">
          <menupopup id="menu_aec_extractPatternFolder_menu-Popup" 
            onpopupshowing="attachmentextractor.updateMRUList(this)" 
            browseText="&attachmentextractor.mrubrowsetext;" 
            paramAll="false" 
            paramPattern="true" />
        </menu>
      </menupopup>
    </menu>
  </menupopup>

  <!-- Menu 'File' -->
  <menupopup id="menu_FilePopup">
    <menuseparator id="aec-menu_FilePopup-separator" 
      insertafter="menu_saveAs" />
    <menu id="aec-menu_FilePopup-menu" 
      label="&attachmentextractor.menu.label;" 
      accesskey="&attachmentextractor.menu.accesskey;" 
      insertafter="aec-menu_FilePopup-separator">
      <menupopup id="aec-menu_FilePopup_menu-Popup" 
        onpopupshowing="attachmentextractor.updateMRUVisability(event)">
        <menuitem id="menu_aec_extractAllToDefault" 
          label="&attachmentextractor.extractalldefault.label;" 
          accesskey="&attachmentextractor.extractalldefault.accesskey;" 
          command="cmd_aec_extractAllToDefault" />
        <menuitem id="menu_aec_extractAllToFolder" 
          label="&attachmentextractor.extractallfolder.label;" 
          accesskey="&attachmentextractor.extractallfolder.accesskey;" 
          aec_mru_menuitem="NONMRU" 
          command="cmd_aec_extractAllToFolder" 
          hidden="true" />
        <menu id="menu_aec_extractAllToFolder_menu" 
          label="&attachmentextractor.extractallfolder.label;" 
          accesskey="&attachmentextractor.extractallfolder.accesskey;" 
          aec_mru_menuitem="MRU" 
          command="cmd_aec_extractAllToFolder_menu">
          <menupopup id="menu_aec_extractAllToFolder_menu-Popup" 
            onpopupshowing="attachmentextractor.updateMRUList(this)" 
            browseText="&attachmentextractor.mrubrowsetext;" 
            paramAll="true" 
            paramPattern="false"/>
        </menu>
        <menuitem id="menu_aec_extractDeepToDefault" 
          label="&attachmentextractor.extractdeepdefault.label;" 
          accesskey="&attachmentextractor.extractdeepdefault.accesskey;" 
          command="cmd_aec_extractDeepToDefault" />
        <menuitem id="menu_aec_extractDeepToFolder" 
          label="&attachmentextractor.extractdeepfolder.label;" 
          accesskey="&attachmentextractor.extractdeepfolder.accesskey;" 
          aec_mru_menuitem="NONMRU" 
          command="cmd_aec_extractDeepToFolder" 
          hidden="true" />
        <menu id="menu_aec_extractDeepToFolder_menu" 
          label="&attachmentextractor.extractdeepfolder.label;" 
          accesskey="&attachmentextractor.extractdeepfolder.accesskey;" 
          aec_mru_menuitem="MRU" 
          command="cmd_aec_extractDeepToFolder_menu">
          <menupopup id="menu_aec_extractDeepToFolder_menu-Popup" 
            onpopupshowing="attachmentextractor.updateMRUList(this)" 
            browseText="&attachmentextractor.mrubrowsetext;" 
            paramAll="2" 
            paramPattern="false"/>
        </menu>
        <menuitem id="menu_aec_extractAllToSuggest_menu" 
          label="&attachmentextractor.extractalltosuggest.label;" 
          accesskey="&attachmentextractor.extractalltosuggest.accesskey;" 
          command="cmd_aec_extractAllToSuggest" />
        <menuitem id="menu_aec_justDeleteAllAttachments" 
          label="&attachmentextractor.justDeleteAllAttachments.label;" 
          accesskey="&attachmentextractor.justDeleteAllAttachments.accesskey;" 
          command="cmd_aec_justDeleteAllAttachments" />

      </menupopup>
    </menu>
  </menupopup>

  <!-- context menu in folder pane -->
  <popup id="folderPaneContext">
    <menuseparator id="aec-folderPaneContext-separator" 
      insertafter="folderPaneContext-rename" />
    <menu id="aec-folderPaneContext-menu" 
      label="&attachmentextractor.menu.label;" 
      accesskey="&attachmentextractor.menu.accesskey;" 
      insertafter="aec-folderPaneContext-separator">
      <menupopup id="">
        <menuitem id="menu_aec_extractAllToSuggest_context" 
          label="&attachmentextractor.context.extractalltosuggest.label;" 
          accesskey="&attachmentextractor.context.extractalltosuggest.accesskey;" 
          command="cmd_aec_extractAllToSuggest" />
        <menuitem id="menu_aec_extractDeepToFolder_context" 
          label="&attachmentextractor.context.extractdeepfolder.label;" 
          accesskey="&attachmentextractor.context.extractdeepfolder.accesskey;" 
          aec_mru_menuitem="NONMRU" 
          command="cmd_aec_extractDeepToFolder" 
          hidden="true"/>
        <menu id="menu_aec_extractDeepToFolder_context_menu" 
          label="&attachmentextractor.context.extractdeepfolder.label;" 
          accesskey="&attachmentextractor.context.extractdeepfolder.accesskey;" 
          aec_mru_menuitem="MRU" 
          command="cmd_aec_extractDeepToFolder_menu">
          <menupopup id="menu_aec_extractDeepToFolder_context_menu-Popup" 
            onpopupshowing="attachmentextractor.updateMRUList(this)" 
            browseText="&attachmentextractor.mrubrowsetext;" 
            paramAll="2" 
            paramPattern="false">
            <menuitem id="menu_aec_extractDeepToDefault_context" 
              label="&attachmentextractor.mru.default.label;" 
              accesskey="&attachmentextractor.mru.default.accesskey;" 
              aec_mru_menuitem="MRU" 
              command="cmd_aec_extractDeepToDefault" />
            <menuseparator aec_mru_menuitem="MRU"/>
          </menupopup>
        </menu>
        <menuitem id="menu_aec_extractDeepToDefault_context" 
          label="&attachmentextractor.context.extractdeepdefault.label;" 
          accesskey="&attachmentextractor.context.extractdeepdefault.accesskey;" 
          aec_mru_menuitem="NONMRU" 
          command="cmd_aec_extractDeepToDefault" />

        <menuitem id="menu_aec_extractAllToFolder_context" 
          label="&attachmentextractor.context.extractallfolder.label;" 
          accesskey="&attachmentextractor.context.extractallfolder.accesskey;" 
          aec_mru_menuitem="NONMRU" 
          command="cmd_aec_extractAllToFolder" 
          hidden="true"/>
        <menu id="menu_aec_extractAllToFolder_context_menu" 
          label="&attachmentextractor.context.extractallfolder.label;" 
          accesskey="&attachmentextractor.context.extractallfolder.accesskey;" 
          aec_mru_menuitem="MRU" 
          command="cmd_aec_extractAllToFolder_menu">
          <menupopup id="menu_aec_extractAllToFolder_context_menu-Popup" 
            onpopupshowing="attachmentextractor.updateMRUList(this)" 
            browseText="&attachmentextractor.mrubrowsetext;" 
            paramAll="true" 
            paramPattern="false"/>
        </menu>
        <menuitem id="menu_aec_extractAllToDefault_context" 
          label="&attachmentextractor.context.extractalldefault.label;" 
          accesskey="&attachmentextractor.context.extractalldefault.accesskey;" 
          command="cmd_aec_extractAllToDefault"/>
      </menupopup>
    </menu>
  </popup>


  <!-- context menu in threadpane and preview pane -->
  <menupopup id="mailContext">
    <menuseparator id="aec-mailContext-separator" 
      insertafter="mailContext-delete">
      <observes element="mailContext-delete" 
        attribute="hidden"/>
    </menuseparator>
    <menu id="aec-mailContext-menu" 
      label="&attachmentextractor.menu.label;" 
      accesskey="&attachmentextractor.menu.accesskey;" 
      insertafter="aec-mailContext-separator">
      <observes element="mailContext-delete" 
        attribute="hidden"/>

      <menupopup id="">
        <menuitem id="menu_aec_extractPatternFolder_context" 
          label="&attachmentextractor.extractpatternfolder.label;" 
          accesskey="&attachmentextractor.extractpatternfolder.accesskey;" 
          aec_mru_menuitem="NONMRU" 
          aec_image_menuitem="NONIMAGE" 
          command="cmd_aec_extractPatternFolder" 
          hidden="true"/>
        <menu id="menu_aec_extractPatternFolder_context_menu" 
          label="&attachmentextractor.extractpatternfolder.label;" 
          accesskey="&attachmentextractor.extractpatternfolder.accesskey;" 
          aec_mru_menuitem="MRU" 
          aec_image_menuitem="NONIMAGE" 
          command="cmd_aec_extractPatternFolder_menu">
          <menupopup id="menu_aec_extractPatternFolder_context_menu-Popup" 
            onpopupshowing="attachmentextractor.updateMRUList(this)" 
            browseText="&attachmentextractor.mrubrowsetext;" 
            paramAll="false" 
            paramPattern="true">
            <menuitem id="menu_aec_extractPatternDefault_context" 
              label="&attachmentextractor.mru.default.label;" 
              accesskey="&attachmentextractor.mru.default.accesskey;" 
              aec_mru_menuitem="MRU" 
              aec_image_menuitem="NONIMAGE" 
              command="cmd_aec_extractPatternDefault" />
            <menuseparator aec_mru_menuitem="MRU"/>
          </menupopup>
        </menu>
        <menuitem id="menu_aec_extractPatternDefault_context" 
          label="&attachmentextractor.extractpattern.label;" 
          accesskey="&attachmentextractor.extractpattern.accesskey;" 
          aec_mru_menuitem="NONMRU" 
          aec_image_menuitem="NONIMAGE" 
          command="cmd_aec_extractPatternDefault" />
        <menuitem id="menu_aec_extractToSuggest_context" 
          label="&attachmentextractor.extracttosuggest.label;" 
          accesskey="&attachmentextractor.extracttosuggest.accesskey;" 
          aec_image_menuitem="NONIMAGE" 
          command="cmd_aec_extractToSuggest" />
        <menuitem id="menu_aec_extractToFolder_context" 
          label="&attachmentextractor.extracttofolder.label;" 
          accesskey="&attachmentextractor.extracttofolder.accesskey;" 
          aec_mru_menuitem="NONMRU" 
          aec_image_menuitem="NONIMAGE" 
          command="cmd_aec_extractToFolder" 
          hidden="true" />
        <menu id="menu_aec_extractToFolder_context_menu" 
          label="&attachmentextractor.extracttofolder.label;" 
          accesskey="&attachmentextractor.extracttofolder.accesskey;" 
          aec_mru_menuitem="MRU" 
          aec_image_menuitem="NONIMAGE" 
          command="cmd_aec_extractToFolder_menu">
          <menupopup id="menu_aec_extractToFolder_context_menu-Popup" 
            onpopupshowing="attachmentextractor.updateMRUList(this)" 
            browseText="&attachmentextractor.mrubrowsetext;" 
            paramAll="false" 
            paramPattern="false"/>
        </menu>
        <menuitem id="menu_aec_extractToDefault_context" 
          label="&attachmentextractor.extracttodefault.label;" 
          accesskey="&attachmentextractor.extracttodefault.accesskey;" 
          aec_image_menuitem="NONIMAGE" 
          command="cmd_aec_extractToDefault" />

        <menuitem id="menu_aec_extractIndToSuggest_context" 
          label="&attachmentextractor.extracttosuggest.label;" 
          accesskey="&attachmentextractor.extracttosuggest.accesskey;" 
          aec_image_menuitem="IMAGE" 
          command="cmd_aec_extractContextToSuggest" />
        <menuitem id="menu_aec_extractIndToFolder_context" 
          label="&attachmentextractor.attachment.extractindtofolder.label;" 
          accesskey="&attachmentextractor.attachment.extractindtofolder.accesskey;" 
          aec_mru_menuitem="NONMRU" 
          aec_image_menuitem="IMAGE" 
          command="cmd_aec_extractContextToFolder" />
        <menu id="menu_aec_extractIndToFolder_context_menu" 
          label="&attachmentextractor.attachment.extractindtofolder.label;" 
          accesskey="&attachmentextractor.attachment.extractindtofolder.accesskey;" 
          aec_mru_menuitem="MRU" 
          aec_image_menuitem="IMAGE" 
          command="cmd_aec_extractContextToFolder_menu">
          <menupopup id="menu_aec_extractIndToFolder_context_menu-Popup" 
            onpopupshowing="attachmentextractor.updateMRUList(this)" 
            browseText="&attachmentextractor.mrubrowsetext;" 
            paramAll="'context'" 
            paramPattern="false" 
            paramIndividual="true" />
        </menu>
        <menuitem id="menu_aec_extractIndToDefault_context" 
          label="&attachmentextractor.attachment.extractindtodefault.label;" 
          accesskey="&attachmentextractor.attachment.extractindtodefault.accesskey;" 
          aec_image_menuitem="IMAGE" 
          command="cmd_aec_extractContextToDefault" />
      </menupopup>
    </menu>
  </menupopup>

</overlay>
